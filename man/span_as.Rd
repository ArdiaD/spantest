% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/span_as.R
\name{span_as}
\alias{span_as}
\title{Subseries-Based Cauchy Combination Test (SCT) for Spanning Hypotheses}
\usage{
span_as(bench, test, control = list())
}
\arguments{
\item{bench}{A numeric matrix of benchmark asset returns (T x K), used as the spanning base.}

\item{test}{A numeric matrix of test asset returns (T x N), to be evaluated for spanning.}

\item{control}{Optional named list of control parameters passed to f_getpv (internal function):
\describe{
\item{\code{ks}}{A numeric vector of subseries exponents controlling block size scaling, \code{c(1/3)} (default).}
\item{\code{L}}{A numeric vector of perturbation scaling constants controlling randomized projection behavior \code{c(0, 2)} (default).}
}}
}
\value{
A named list of global p-values for each hypothesis type and configuration:
\describe{
\item{\code{CCTd}}{Global p-value for the null \eqn{\delta = 0} (no slope deviation).}
\item{\code{CCTa}}{Global p-value for the null \eqn{\alpha = 0} (no intercept deviation).}
\item{\code{CCTad}}{Global p-value for the joint null \eqn{\alpha = 0, \delta = 0}.}
}
Each entry is suffixed by the subseries settings used, e.g., \code{CCTa_L0_k1}.
}
\description{
Computes robust p-values for testing spanning-related linear restrictions using the residual-based
subseries method. This function supports high-dimensional inference on hypotheses such as
\eqn{H_0^\delta}, \eqn{H_0^\alpha}, and their joint null \eqn{H_0^{\alpha, \delta}} using
a simulation-based approximation and aggregation via the Cauchy Combination Test (CCT).
}
\details{
The function performs residual-based inference by dividing the data into overlapping subseries
of length approximately \code{floor(T^k)} for each exponent \code{k} in \code{ks}. Randomized
perturbations of residuals controlled by \code{L} generate test statistics robust to serial
and cross-sectional dependence. P-values from these subseries tests are combined using the
Cauchy Combination Test (CCT), which controls for dependence between tests and retains good
power in high dimensions.

The naming convention of the output encodes the test type:
\itemize{
\item \code{CCTd}: minimum-variance (delta) spanning test,
\item \code{CCTa}: max Sharpe (alpha) spanning test,
\item \code{CCTad}: Full mean variance spanning (MVS), joint test of alpha and delta.
}
Suffixes specify the perturbation scale \code{L} and block size index \code{k}.

This method is particularly useful in large asset universes where classical F-tests or GRS
tests become invalid due to dimensionality and complex dependence structures.
However, computation time increases with sample size and number of simulations.
}
\examples{
set.seed(123)
bench <- matrix(rnorm(300), nrow = 100, ncol = 3)  # Benchmark assets
test  <- matrix(rnorm(200), nrow = 100, ncol = 2)  # Test assets
span_as(bench, test)
}
\references{
Ardia, D., & Sessinou, M. (2025) "High-Dimensional Mean-Variance Spanning Tests" \emph{working paper}.\cr
}
